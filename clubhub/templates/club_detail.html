{% load static %}
<!doctype html>
<html>
<head>
    <title>{{ club.name }}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-left">
            <h2>StoryHub</h2>
        </div>
        <div class="nav-right">
            <a href="{% url 'dashboard' %}">Home</a>
            <a href="{% url 'club_list' %}">Browse Clubs</a>
            <a href="{% url 'recent_clubs' %}">Recently Joined</a>
            <a href="{% url 'logout' %}">Logout</a>
        </div>
    </nav>

    <!-- Django messages -->
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="club-container">
        <h2>{{ club.name }}</h2>
        <p>{{ club.description }}</p>

        <!-- External samples -->
        {% if club.media_type == "book" %}
            <h3>Sample Books</h3>
        {% elif club.media_type == "movie" %}
            <h3>Sample Movies</h3>
        {% endif %}

        <div class="card-grid">
            {% if club.sample_title_1 %}
            <div class="card">
                {% if club.sample_image_1 %}
                    <img src="{{ club.sample_image_1.url }}" alt="{{ club.sample_title_1 }}" class="sample-img">
                {% endif %}
                <h4>{{ club.sample_title_1 }}</h4>
                <p><strong>{{ club.sample_author_director_1 }}</strong></p>
                <p>{{ club.sample_description_1 }}</p>
                {% if club.sample_link_1 %}
                    <a href="{{ club.sample_link_1 }}" target="_blank" class="btn">View</a>
                {% endif %}
            </div>
            {% endif %}

            {% if club.sample_title_2 %}
            <div class="card">
                {% if club.sample_image_2 %}
                    <img src="{{ club.sample_image_2.url }}" alt="{{ club.sample_title_2 }}" class="sample-img">
                {% endif %}
                <h4>{{ club.sample_title_2 }}</h4>
                <p><strong>{{ club.sample_author_director_2 }}</strong></p>
                <p>{{ club.sample_description_2 }}</p>
                {% if club.sample_link_2 %}
                    <a href="{{ club.sample_link_2 }}" target="_blank" class="btn">View</a>
                {% endif %}
            </div>
            {% endif %}
        </div>

        <!-- Membership logic -->
        {% if user.is_authenticated %}
            {% if user in club.members.all %}
                <p>You are a member of this club.</p>
                <!-- Request to leave button -->
                <form method="post">
                    {% csrf_token %}
                    <button type="submit" name="request_leave">Request to Leave</button>
                </form>
            {% else %}
                <form method="post">
                    {% csrf_token %}
                    <button type="submit" name="join">Join Club</button>
                </form>
            {% endif %}

            <h3>Members:</h3>
            <ul>
                {% for member in club.members.all %}
                    <li>{{ member.username }}</li>
                {% empty %}
                    <li>No members yet.</li>
                {% endfor %}
            </ul>
        {% else %}
            <p><a href="{% url 'login' %}">Login</a> to join this club.</p>
        {% endif %}
    
    <h3>Give Feedback</h3>
<form method="post">
    {% csrf_token %}
    {{ feedback_form.as_p }}
    <button type="submit" name="feedback">Submit Feedback</button>
</form>

<h3>Feedback from Members</h3>
<ul>
    {% for fb in club.feedbacks.all %}
        <li><strong>{{ fb.user.username }}:</strong> {{ fb.message }} ({{ fb.created_at|date:"M d, Y H:i" }})</li>
    {% empty %}
        <li>No feedback yet.</li>
    {% endfor %}
</ul>
</div>

    <!-- Footer -->
    <footer>
        <p>Connect with us:</p>
        <div class="social-icons">
            <a href="#"><img src="{% static 'svg/instagram.svg' %}" alt="Instagram"></a>
            <a href="#"><img src="{% static 'svg/twitter.svg' %}" alt="Twitter"></a>
            <a href="#"><img src="{% static 'svg/tiktok.svg' %}" alt="TikTok"></a>
        </div>
        <p>&copy; {% now "Y" %} ClubHub. All rights reserved.</p>
    </footer>
</body>
</html>







